// Custom toggle switch that works on iOS (bypasses Shadow DOM rendering issues)
.custom-toggle-wrapper {
  display: flex;
  align-items: center;
  justify-content: center;
}

.custom-toggle {
  position: relative;
  display: inline-block;
  width: 51px;
  height: 31px;
  margin: 0;
  cursor: pointer;
  
  input {
    opacity: 0;
    width: 0;
    height: 0;
    
    &:checked + .toggle-slider {
      background-color: #34c759; // iOS green
    }
    
    &:checked + .toggle-slider:before {
      transform: translateX(20px);
    }
  }
  
  .toggle-slider {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #e5e5ea; // iOS gray
    border-radius: 31px;
    transition: 0.3s;
    
    &:before {
      content: '';
      position: absolute;
      height: 27px;
      width: 27px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      border-radius: 50%;
      transition: 0.3s;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
    }
  }
}

:host {
  
  ion-list { 
    padding: 0;
    margin-top: 0;
  }
  
  ion-item { 
    --inner-padding-end: 16px;
    --min-height: 60px;
    align-items: center;
  }
  
  ion-item::part(native) {
    align-items: center;
  }
  
  /* Ensure selects expand and are visible, especially with a start icon */
  ion-item ion-select {
    display: block;
    width: 100%;
  }

  /* Make the select row comfortably tall on iOS to ensure the trigger is visible */
  ion-item.select-row {
    --min-height: 64px;
  }

  /* Standalone select styling to ensure visibility when not inside ion-item */
  ion-select.language-select {
    display: block;
    width: 100%;
    margin: 8px 0 4px 0;
    padding: 0 16px;
  }
  /* TEMP debug visuals; safe to remove after verification */
  /* ion-select.language-select { border: 1px dashed var(--ion-color-medium); border-radius: 8px; } */

  /* Lay out label + control ourselves (no end slot needed) */
  .row {
    display: grid;
    grid-template-columns: 1fr auto; /* label then control */
    column-gap: 12px;
    width: 100%;
    min-width: 0;
  }

  .row ion-label {
    min-width: 0;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Controls at the end: guaranteed footprint */
  .row .end { min-width: 0; }
  .row ion-select.end { min-width: 160px; }  /* adjust to taste */
  .row ion-toggle.end { min-width: 72px;  }

  /* Native Ionic layout support (slot="end") */
  ion-item ion-select[slot="end"] {
    flex: 0 0 auto;
    min-width: 160px;
    margin-inline-start: auto; /* ensure it sits at the end on iOS */
  }

  /* When you re-add ranges */
  .row .fill { width: 100%; height: 44px; }

  /* Make select readable regardless of theme variables */
  ion-select::part(text),
  ion-select::part(placeholder) { color: var(--ion-text-color, #111); opacity: 1; }
  ion-select::part(icon) { color: var(--ion-text-color, #111); }
}

/* Temporary: confirm no style is collapsing ion-select on iOS */
:host-context(.ios) ion-select {
  display: block !important;
  visibility: visible !important;
  min-height: 44px !important;
  --padding-start: 0; /* optional, keeps it neat in stacked mode */
}
:host-context(.ios) ion-item ion-select { width: 100%; } /* avoid zero-width flex bugs */

/* 1) Make sure the field actually has a box on iOS */
:host-context(.ios) ion-item > ion-select {
  display: block !important;
  min-height: 44px !important;   /* standard row height */
  width: 100% !important;
  flex: 1 1 auto !important;     /* prevents zero-width flex collapse */
}

/* 2) If any global reset set 'display: contents' on form controls, undo it */
:host-context(.ios) ion-select {
  display: block !important;
}

/* 3) Ensure proper vertical alignment for detail icons and labels */
:host-context(.ios) ion-item {
  align-items: center !important;
}

:host-context(.ios) ion-item::part(native) {
  align-items: center !important;
}

/* 4) TEMP: draw a border around the select's visible container to confirm it renders */
:host-context(.ios) ion-select::part(container) {
  border: 1px dashed rgba(0,0,0,.3);
  border-radius: 8px;
  min-height: 44px;
  padding: 6px 10px;
}

/* 5) Custom toggle used instead of ion-toggle to bypass iOS Shadow DOM issues */
