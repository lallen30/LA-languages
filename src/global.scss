/* ============================================================================
   global.scss  â€” safe baseline + scoped fixes
   ============================================================================ */

/* --- Ionic core + utilities (required) ------------------------------------ */
@import "@ionic/angular/css/core.css";
@import "@ionic/angular/css/normalize.css";
@import "@ionic/angular/css/structure.css";
@import "@ionic/angular/css/typography.css";
@import "@ionic/angular/css/display.css";

/* Optional Ionic utility imports */
@import "@ionic/angular/css/padding.css";
@import "@ionic/angular/css/float-elements.css";
@import "@ionic/angular/css/text-alignment.css";
@import "@ionic/angular/css/text-transformation.css";
@import "@ionic/angular/css/flex-utils.css";

/* --- App-wide base (safe; no structural overrides of Ionic components) ---- */
html, body {
  background: var(--ion-background-color);
  color: var(--ion-text-color);
  margin: 0;
  padding: 0;
  height: 100%;
  width: 100%;
  overflow: hidden;
}

ion-app {
  background: var(--ion-background-color);
  color: var(--ion-text-color);
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
}

ion-content {
  background: var(--ion-background-color);
  color: var(--ion-text-color);
}

/* Smoother text rendering */
html {
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Remove any accidental list bullets from custom content */
ul, ol { margin: 0; padding-left: 1.25rem; }

/* ============================================================================
   IMPORTANT: We intentionally DO NOT change layout of Ionic components here.
   The following risky patterns have been removed (do not re-add globally):
   - ion-item { display: block; }             // breaks internal flex row
   - ion-label { width: 100%; }               // causes end-slot to collapse
   - ion-item { --inner-padding-end: 0; }     // robs space from the end slot
   If you need tighter rows on a specific page, scope it (see below).
   ============================================================================ */

/* --- Page-scoped styling for the Settings page list ----------------------- */
/* Only affects the main Settings list, NOT modals */
/* Removed empty ruleset - add specific styles here if needed */

/* --- Scoped visual tweaks for the TTS modal (no layout overrides) --------- */
/* Keep only safe color tweaks; rely on native Ionic item layout */

/* Optional: ensure select/toggle look good regardless of theme variables */
ion-modal app-tts-modal ion-select::part(text),
ion-modal app-tts-modal ion-select::part(placeholder) {
  color: var(--ion-text-color, #111);
  opacity: 1;
}
ion-modal app-tts-modal ion-select::part(icon) {
  color: var(--ion-text-color, #111);
}
ion-modal app-tts-modal ion-toggle::part(track) {
  background: color-mix(in srgb, var(--ion-text-color, #111) 20%, transparent);
}
ion-modal app-tts-modal ion-toggle.toggle-checked::part(track) {
  background: color-mix(in srgb, var(--ion-color-primary, #428cff) 55%, transparent);
}
ion-modal app-tts-modal ion-toggle::part(handle) {
  background: #fff;
}

/* --- Small quality-of-life tweaks (safe) ---------------------------------- */
ion-button[fill="outline"] {
  --border-width: 2px;
}

/* --- Fullscreen modal utility -------------------------------------------- */
/* Applied from Settings via cssClass: 'modal-fullscreen' */
ion-modal.modal-fullscreen {
  /* Make the modal occupy the full viewport */
  --height: 100%;
  --max-height: 100%;
  --width: 100%;
  --border-radius: 0;
}

/* Ensure the shadow DOM content stretches fully */
ion-modal.modal-fullscreen::part(content) {
  height: 100%;
}

/* Optional: make inner ion-content fill too, in case components rely on it */
ion-modal.modal-fullscreen ion-content {
  height: 100%;
}

/* ============================================================================
   iOS CRITICAL FIX: Global clickability issue - NUCLEAR OPTION
   ============================================================================ */
@media (max-width: 768px) {
  /* Force hardware acceleration off to prevent compositing layer issues */
  * {
    transform: none !important;
    will-change: auto !important;
    backface-visibility: visible !important;
  }
  
  /* Ensure all clickable elements have proper touch targets */
  ion-button, ion-item, ion-tab-button, button, a {
    min-height: 44px !important;
  }
  
  /* Ensure content doesn't go under fixed tab bar */
  ion-content {
    --padding-bottom: 70px;
  }
  
  /* Ensure ion-item clicks work */
  ion-item::part(native) {
    min-height: 56px !important;
  }
}
